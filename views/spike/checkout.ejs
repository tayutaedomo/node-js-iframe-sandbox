<% layout('layout') %>

<h1><%= title %></h1>

<div class="row">
  <div class="col-sm-12">
    <button id="button1" name="purchase" class="btn btn-info">支払う</button>
  </div>
</div>

<script src="https://checkout.spike.cc/v1/checkout.js"></script>
<script>
  var handler = SpikeCheckout.configure({
    key: 'pk_test_wMkeqKbI8EAW7JoqouAwYC8v',
    token: function(token) {
      $('<input>')
        .attr('type', 'hidden')
        .attr('name', 'card_token')
        .val(token.id)
        .appendTo('form');
      $('form').submit();
    },
    opened: function() {
      // Window opened event
    },
    closed: function() {
      // Window closed event
    }
  });

  document.getElementById('button1').addEventListener('click', function(e) {
    handler.open({
      name: 'オンラインショップ',
      currency: 'JPY',
      email: 'foo@example.com'
    });
    e.preventDefault();
  });
</script>

